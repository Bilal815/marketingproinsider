<style>

</style>

<p>{{ SITEURL }}</p>
<input type="hidden" id="hidden-input" value='[
  {% for article in articles %}
    {
      "thumbnail": "{{ article.thumbnail }}",
      "category": "{{ article.category}}",
      "alt": "{{ article.alt }}",
      "slug": "{{ article.slug }}",
      "title": "{{ article.title }}",
      "author": [
      {"name":"{{ article.author }}", "url":"{{ article.author.url }}"}      
      ],
      "date": "{{ article.date.strftime("%B %d, %Y") }}",
      "resume": 
      {% if article.resume %}
      "{{ article.resume }}",
      {% else %}
      "",
      {% endif %}
      "tags": [
      {% for tag in article.tags %}
      { "name": "{{ tag }}", "url": "{{ tag.url }}" }{% if not loop.last %},{% endif %}
      {% endfor %}
      ],
      "SITEURL": "{{ SITEURL }}"
    }
    {% if not loop.last %},{% endif %}
  {% endfor %}
]'>

<div class="row" id="articles-container">
  <!-- Waiting for data to load here through id-->  
</div>
<div id="load-more-button" class="col-lg-12">
  {# <!-- Include the partial for pagination -->
  {% include 'partial/pagination.html' %} #}
</div>

<button onclick="topFunction()" id="myBtn" title="Go to top">&#94;</button>

<script>
// Get the hidden input field
var hiddenInput = document.getElementById('hidden-input');
var articlesContainer = document.getElementById('articles-container');
var loadMoreButton = document.getElementById('load-more-button');

// Initial display of articles
displayArticles(0, 7);

// Load more button click event
loadMoreButton.addEventListener('click', function() {
  var startIndex = articlesContainer.children.length;
  var endIndex = startIndex + 7;
  displayArticles(startIndex, endIndex);
});


// Get the JSON value from the hidden input field
var inputValueJson = hiddenInput.value;

// Parse the JSON value
var inputArray = JSON.parse(inputValueJson);

// Get the button
let mybutton = document.getElementById("myBtn");

// Function to display articles
function displayArticles(startIndex, endIndex) {

// Display articles within the specified range
for (var i = startIndex; i < endIndex && i < inputArray.length; i++) {
  var article = inputArray[i];
  var articleHtml = `
  <div class="col-lg-6">
    <div class="blog-post">
      <div class="blog-thumb">
        <img loading="lazy" src="${article.SITEURL}/${article.thumbnail}" alt="${article.alt || ''}">
      </div>
      <div class="down-content">
        <span>${article.category}</span>
        <a href="${article.slug}"><h4>${article.title}</h4></a>
        <ul class="post-info">
          ${article.author.map(author => `<li><a href="${author.url}">${author.name}</a></li>`).join('')}
          <li><a href="">${article.date}</a></li>
        </ul>
        ${article.resume ? `<p>${article.resume}</p>` : ''}
        <div class="post-options">
          <ul class="post-tags">
            <li>
              <i class="fa fa-tags"></i>
            </li>
            ${article.tags.map((tag, index) => `<li><a href="${tag.url}">${tag.name}</a>${index !== article.tags.length - 1 ? ' , ' : ''}</li>`).join(' ')}
          </ul>
        </div>
      </div>
    </div>
  </div>
  `;
  articlesContainer.insertAdjacentHTML('beforeend', articleHtml);
}

// Show load more button if more articles exist
if (inputArray.length > 7 && endIndex < inputArray.length) {
  loadMoreButton.style.display = 'block';
} else {
  loadMoreButton.style.display = 'none';
  }
}

// When the user scrolls down 200px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>